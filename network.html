<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Discovery | AI Sentinel-X</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00ff88;
            --secondary: #00ccff;
            --accent: #7c3aed;
            --danger: #ff0044;
            --warning: #ffaa00;
            --success: #00ff88;
            --bg-dark: #0a0e1a;
            --bg-darker: #060912;
            --bg-card: rgba(10, 20, 40, 0.8);
            --border: rgba(0, 255, 136, 0.2);
            --text-primary: #ffffff;
            --text-secondary: #8892b0;
            --gradient-1: linear-gradient(135deg, #00ff88 0%, #00ccff 100%);
            --gradient-2: linear-gradient(135deg, #7c3aed 0%, #00ccff 100%);
            --gradient-shield: linear-gradient(135deg, #1a4d2e 0%, #00ff88 50%, #00ccff 100%);
            --gradient-network: linear-gradient(135deg, #00ccff 0%, #0066ff 100%);
            --gradient-external: linear-gradient(135deg, #ff0044 0%, #ff6644 100%);
            --gradient-internal: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
            --gradient-datacenter: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            --gradient-business: linear-gradient(135deg, #9333ea 0%, #c084fc 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Consolas', 'Monaco', monospace;
            background: var(--bg-darker);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .dot-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, rgba(0, 255, 136, 0.15) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: dotMove 40s linear infinite;
        }

        @keyframes dotMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        /* Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 25px 35px;
            margin-bottom: 30px;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .logo-container {
            width: 80px;
            height: 80px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-shield {
            width: 50px;
            height: 50px;
            background: var(--gradient-shield);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            position: relative;
            animation: shieldPulse 3s ease-in-out infinite;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes shieldPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .logo-eye {
            position: absolute;
            width: 30px;
            height: 30px;
            background: var(--bg-darker);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-iris {
            width: 20px;
            height: 20px;
            background: var(--gradient-1);
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.8);
        }

        .rotating-dots {
            position: absolute;
            width: 100%;
            height: 100%;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .dot {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 6px var(--primary);
        }

        .dot:nth-child(1) { top: 0; left: 50%; transform: translateX(-50%); }
        .dot:nth-child(2) { top: 50%; right: 0; transform: translateY(-50%); }
        .dot:nth-child(3) { bottom: 0; left: 50%; transform: translateX(-50%); }

        .brand-info {
            display: flex;
            flex-direction: column;
        }

        .brand-name {
            font-size: 28px;
            font-weight: bold;
            letter-spacing: 2px;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .brand-tagline {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        /* Scale Detection Indicator */
        .scale-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .scale-individual {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--primary);
            color: var(--primary);
        }

        .scale-business {
            background: rgba(147, 51, 234, 0.1);
            border-color: #9333ea;
            color: #9333ea;
        }

        .scale-enterprise {
            background: rgba(255, 107, 53, 0.1);
            border-color: #ff6b35;
            color: #ff6b35;
        }

        /* Encryption Status Badges */
        .encryption-badges {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .encryption-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .encryption-badge.classical {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--primary);
            color: var(--primary);
        }

        .encryption-badge.quantum {
            background: rgba(124, 58, 237, 0.1);
            border-color: var(--accent);
            color: var(--accent);
        }

        .status-light {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: statusPulse 2s ease-in-out infinite;
        }

        .status-light.active {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        .agent-status {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 20px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--primary);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .agent-status:hover {
            background: rgba(0, 255, 136, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.3);
        }

        .agent-icon {
            font-size: 20px;
        }

        .agent-info {
            display: flex;
            flex-direction: column;
        }

        .agent-title {
            font-weight: bold;
            font-size: 14px;
            color: var(--primary);
        }

        .agent-status-text {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .logout-btn {
            background: transparent;
            border: 1px solid rgba(255, 0, 68, 0.3);
            border-radius: 8px;
            padding: 10px 20px;
            color: var(--danger);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 68, 0.1);
            transform: translateY(-2px);
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            background: var(--bg-card);
            padding: 12px;
            border-radius: 15px;
            border: 1px solid var(--border);
            overflow-x: auto;
            backdrop-filter: blur(15px);
        }

        .nav-tab {
            padding: 12px 24px;
            background: transparent;
            border: 1px solid transparent;
            border-radius: 10px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            text-transform: uppercase;
            font-size: 13px;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .nav-tab:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--border);
            color: var(--primary);
        }

        .nav-tab.active {
            background: var(--gradient-1);
            color: var(--bg-darker);
            font-weight: bold;
        }

        /* Enhanced Environment Detection */
        .environment-detection {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            backdrop-filter: blur(15px);
            text-align: center;
        }

        .detection-title {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .detection-description {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 35px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Auto-Scan Section */
        .auto-scan-section {
            margin-bottom: 40px;
        }

        .auto-scan-btn {
            background: var(--gradient-1);
            border: none;
            border-radius: 20px;
            padding: 20px 40px;
            color: var(--bg-darker);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            margin: 0 auto;
            min-width: 280px;
            box-shadow: 0 8px 25px rgba(0, 255, 136, 0.3);
        }

        .auto-scan-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 255, 136, 0.4);
        }

        .auto-scan-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .scan-icon {
            font-size: 24px;
        }

        .scan-text {
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .scan-subtitle {
            font-size: 14px;
            opacity: 0.8;
        }

        /* Scan Progress */
        .scan-progress {
            margin-top: 20px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            background: var(--gradient-1);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .progress-text {
            color: var(--text-secondary);
            font-size: 14px;
            font-style: italic;
        }

        /* Solution Divider */
        .solution-divider {
            margin: 40px 0 30px 0;
            position: relative;
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .solution-divider::before,
        .solution-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: var(--border);
        }

        .solution-divider::before {
            left: 0;
        }

        .solution-divider::after {
            right: 0;
        }

        /* Enhanced Scale Options */
        .scale-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .scale-option {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .scale-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .scale-option:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.2);
            border-color: var(--primary);
        }

        .scale-option:hover::before {
            opacity: 1;
        }

        .scale-option.selected {
            border-color: var(--primary);
            background: rgba(0, 255, 136, 0.1);
            transform: translateY(-5px);
        }

        .scale-option.selected::before {
            opacity: 1;
        }

        .scale-option.business:hover,
        .scale-option.business.selected {
            border-color: #9333ea;
            box-shadow: 0 15px 40px rgba(147, 51, 234, 0.2);
        }

        .scale-option.business::before {
            background: linear-gradient(90deg, transparent, #9333ea, transparent);
        }

        .scale-option.enterprise:hover,
        .scale-option.enterprise.selected {
            border-color: #ff6b35;
            box-shadow: 0 15px 40px rgba(255, 107, 53, 0.2);
        }

        .scale-option.enterprise::before {
            background: linear-gradient(90deg, transparent, #ff6b35, transparent);
        }

        /* Scale Option Header */
        .scale-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .scale-icon {
            font-size: 48px;
        }

        .scale-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .scale-badge.starter {
            background: rgba(0, 255, 136, 0.2);
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .scale-badge.professional {
            background: rgba(147, 51, 234, 0.2);
            color: #9333ea;
            border: 1px solid #9333ea;
        }

        .scale-badge.enterprise {
            background: rgba(255, 107, 53, 0.2);
            color: #ff6b35;
            border: 1px solid #ff6b35;
        }

        .scale-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .scale-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Scale Features */
        .scale-features {
            margin-bottom: 20px;
        }

        .feature {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            line-height: 1.5;
        }

        .feature::before {
            content: '';
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .business .feature::before {
            background: #9333ea;
        }

        .enterprise .feature::before {
            background: #ff6b35;
        }

        /* Scale Coverage instead of pricing */
        .scale-coverage {
            font-size: 16px;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
            padding: 12px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .business .scale-coverage {
            color: #9333ea;
            background: rgba(147, 51, 234, 0.1);
            border-color: rgba(147, 51, 234, 0.3);
        }

        .enterprise .scale-coverage {
            color: #ff6b35;
            background: rgba(255, 107, 53, 0.1);
            border-color: rgba(255, 107, 53, 0.3);
        }

        /* Solution Footer */
        .solution-footer {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
        }

        .solution-footer p {
            margin-bottom: 10px;
        }

        .solution-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: bold;
        }

        .solution-footer a:hover {
            color: var(--secondary);
            text-decoration: underline;
        }

        /* Rest of the existing CSS continues here... */
        
        /* Sub-Agent Status - Adaptive */
        .sub-agent-status {
            background: linear-gradient(135deg, rgba(0, 204, 255, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            border: 1px solid rgba(0, 204, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            backdrop-filter: blur(15px);
        }

        .sub-agent-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sub-agent-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(0, 204, 255, 0.3);
        }

        .sub-agent-details h3 {
            font-size: 18px;
            color: var(--secondary);
            margin-bottom: 5px;
        }

        .sub-agent-details p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .sub-agent-metrics {
            display: flex;
            gap: 30px;
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--secondary);
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* IP Range Manager */
        .ip-range-manager {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(20px);
        }

        .ip-range-manager.hidden {
            display: none;
        }

        .ip-range-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 15px;
        }

        .ip-range-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ip-range-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .add-range-btn {
            background: var(--gradient-datacenter);
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 12px;
        }

        .add-range-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.4);
        }

        .add-range-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .reset-config-btn {
            background: linear-gradient(135deg, rgba(255, 170, 0, 0.1) 0%, rgba(0, 204, 255, 0.05) 100%);
            border: 2px solid rgba(255, 170, 0, 0.4);
            border-radius: 20px;
            padding: 10px 20px;
            color: var(--warning);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
        }

        .reset-config-btn:hover {
            background: linear-gradient(135deg, rgba(255, 170, 0, 0.2) 0%, rgba(0, 204, 255, 0.1) 100%);
            border-color: var(--warning);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 170, 0, 0.3);
        }

        .reset-config-btn .icon {
            font-size: 14px;
            transition: transform 0.3s ease;
        }

        .reset-config-btn:hover .icon {
            transform: rotate(180deg);
        }

        /* Interactive Dashboard */
        .dashboard-interactive {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(20px);
        }

        .interactive-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 15px;
        }

        .interactive-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .auto-scan-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.3s ease;
            max-height: 80vh;
            overflow-y: auto;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .modal-content {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .modal-btn-primary {
            background: var(--gradient-1);
            color: var(--bg-darker);
        }

        .modal-btn-secondary {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-secondary);
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        /* AI Chat Widget */
        .ai-chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .ai-chat-toggle {
            width: 60px;
            height: 60px;
            background: var(--gradient-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.4);
            transition: all 0.3s ease;
            font-size: 28px;
        }

        .ai-chat-toggle:hover {
            transform: scale(1.1);
        }

        .ai-chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 400px;
            height: 600px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            display: none;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
        }

        .ai-chat-window.active {
            display: flex;
            animation: chatSlideIn 0.3s ease;
        }

        @keyframes chatSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-chat-header {
            background: var(--gradient-1);
            color: var(--bg-darker);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
        }

        .ai-chat-status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .chat-status-dot {
            width: 8px;
            height: 8px;
            background: var(--bg-darker);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .ai-chat-close {
            cursor: pointer;
            font-size: 24px;
        }

        .cli-mode-indicator {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 10px;
            margin: 0 20px;
            text-align: center;
            font-size: 12px;
            color: var(--warning);
            display: none;
        }

        .cli-mode-indicator.active {
            display: block;
        }

        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-message-bubble {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 15px 20px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .ai-message-bubble.user {
            background: rgba(0, 204, 255, 0.1);
            border-color: var(--secondary);
            align-self: flex-end;
        }

        .ai-message-bubble.system {
            background: rgba(124, 58, 237, 0.1);
            border-color: var(--accent);
            font-size: 13px;
            font-style: italic;
        }

        .ai-message-time {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .ai-chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .ai-chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 12px 15px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .ai-chat-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .ai-chat-send {
            background: var(--gradient-1);
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            color: var(--bg-darker);
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
            }
            
            .scale-options {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-window {
                width: calc(100vw - 40px);
                height: calc(100vh - 120px);
                right: -20px;
                bottom: 80px;
            }
        }
    </style>
</head>
<body>
    <script>
        // Check authentication
        const auth = localStorage.getItem('sentinel_auth');
        if (!auth) {
            window.location.href = 'index.html';
        } else {
            const authData = JSON.parse(auth);
            if (Date.now() - authData.timestamp > 24 * 60 * 60 * 1000) {
                localStorage.removeItem('sentinel_auth');
                window.location.href = 'index.html';
            }
        }
    </script>

    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="dot-grid"></div>
    </div>

    <!-- Container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo-container">
                        <div class="rotating-dots">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                        <div class="logo-shield">
                            <div class="logo-eye">
                                <div class="logo-iris"></div>
                            </div>
                        </div>
                    </div>
                    <div class="brand-info">
                        <h1 class="brand-name">AI SENTINEL-X</h1>
                        <p class="brand-tagline">Autonomous Cyber Defense</p>
                    </div>
                </div>
                <div class="header-right">
                    <!-- Adaptive Scale Indicator -->
                    <div class="scale-indicator scale-individual" id="scaleIndicator">
                        <span id="scaleIcon">üîç</span>
                        <span id="scaleText">DETECTING</span>
                    </div>
                    
                    <!-- Encryption Badges -->
                    <div class="encryption-badges">
                        <div class="encryption-badge classical">
                            <div class="status-light active" id="classicalStatus"></div>
                            <span>CLASSICAL</span>
                        </div>
                        <div class="encryption-badge quantum">
                            <div class="status-light active" id="quantumStatus"></div>
                            <span>QUANTUM</span>
                        </div>
                    </div>
                    
                    <div class="agent-status" onclick="showAgentShutdownModal()">
                        <span class="agent-icon">ü§ñ</span>
                        <div class="agent-info">
                            <span class="agent-title">AI Agent Active</span>
                            <span class="agent-status-text" id="agentModeText">Adaptive Configuration</span>
                        </div>
                    </div>
                    
                    <button class="logout-btn" onclick="handleLogout()">Logout</button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <a href="dashboard.html" class="nav-tab">
                <span>üè†</span>
                <span>Dashboard</span>
            </a>
            <a href="threats.html" class="nav-tab">
                <span>üõ°Ô∏è</span>
                <span>Threats</span>
            </a>
            <a href="#" class="nav-tab active">
                <span>üåê</span>
                <span>Network</span>
            </a>
            <a href="defense.html" class="nav-tab">
                <span>‚öîÔ∏è</span>
                <span>Defense</span>
            </a>
            <a href="ai-engine.html" class="nav-tab">
                <span>üß†</span>
                <span>AI Engine</span>
            </a>
            <a href="encryption.html" class="nav-tab">
                <span>üîê</span>
                <span>Encryption</span>
            </a>
            <a href="analytics.html" class="nav-tab">
                <span>üìä</span>
                <span>Analytics</span>
            </a>
            <a href="settings.html" class="nav-tab">
                <span>‚öôÔ∏è</span>
                <span>Settings</span>
            </a>
        </nav>

        <!-- Environment Detection with Auto-Scan -->
        <div class="environment-detection" id="environmentDetection">
            <div class="detection-title">üéØ Intelligent Network Discovery</div>
            <div class="detection-description">
                AI Sentinel-X will automatically discover and analyze your network infrastructure to configure optimal security monitoring. Your license includes base protection - additional monitoring can be configured based on your actual needs.
            </div>
            
            <div class="auto-scan-section">
                <button class="auto-scan-btn" onclick="startAutoScan()" id="autoScanBtn">
                    <span class="scan-icon">üîç</span>
                    <span class="scan-text">Auto-Scan My Network</span>
                    <span class="scan-subtitle">Detect infrastructure & configure monitoring</span>
                </button>
                <div class="scan-progress" id="scanProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">Scanning network infrastructure...</div>
                </div>
            </div>
            
            <div class="solution-divider">
                <span>Or manually configure your deployment:</span>
            </div>
            
            <div class="scale-options">
                <div class="scale-option individual" onclick="selectScale('individual')">
                    <div class="scale-header">
                        <div class="scale-icon">üåê</div>
                        <div class="scale-badge starter">ESSENTIAL</div>
                    </div>
                    <div class="scale-title">Single Server Protection</div>
                    <div class="scale-subtitle">Individual Server ‚Ä¢ VPS ‚Ä¢ Cloud Instance</div>
                    <div class="scale-features">
                        <div class="feature">‚úì Real-time threat monitoring</div>
                        <div class="feature">‚úì Hybrid-resistant encryption</div>
                        <div class="feature">‚úì Automated incident response</div>
                        <div class="feature">‚úì Basic network discovery</div>
                    </div>
                    <div class="scale-coverage">Monitors: 1 IP address</div>
                </div>
                
                <div class="scale-option business" onclick="selectScale('business')">
                    <div class="scale-header">
                        <div class="scale-icon">üè¢</div>
                        <div class="scale-badge professional">BUSINESS</div>
                    </div>
                    <div class="scale-title">Multi-Site Security</div>
                    <div class="scale-subtitle">Small-Medium Business ‚Ä¢ Multi-Location</div>
                    <div class="scale-features">
                        <div class="feature">‚úì Everything in Essential</div>
                        <div class="feature">‚úì Cross-location correlation</div>
                        <div class="feature">‚úì Advanced threat intelligence</div>
                        <div class="feature">‚úì Business compliance reports</div>
                        <div class="feature">‚úì Extended monitoring range</div>
                    </div>
                    <div class="scale-coverage">Monitors: Up to 50 IP addresses</div>
                </div>
                
                <div class="scale-option enterprise" onclick="selectScale('enterprise')">
                    <div class="scale-header">
                        <div class="scale-icon">üè≠</div>
                        <div class="scale-badge enterprise">ENTERPRISE</div>
                    </div>
                    <div class="scale-title">Global Infrastructure Defense</div>
                    <div class="scale-subtitle">Data Centers ‚Ä¢ Global Infrastructure</div>
                    <div class="scale-features">
                        <div class="feature">‚úì Everything in Business</div>
                        <div class="feature">‚úì Global threat correlation</div>
                        <div class="feature">‚úì Custom threat modeling</div>
                        <div class="feature">‚úì SOC integration & APIs</div>
                        <div class="feature">‚úì Unlimited monitoring scope</div>
                    </div>
                    <div class="scale-coverage">Monitors: Unlimited IP addresses</div>
                </div>
            </div>
            
            <div class="solution-footer">
                <p>üõ°Ô∏è Your base license includes essential protection. Additional monitoring capabilities can be configured based on your actual infrastructure needs.</p>
                <p>üìä Usage-based billing ensures you only pay for what you actually need to monitor.</p>
            </div>
        </div>

        <!-- Sub-Agent Status -->
        <div class="sub-agent-status" id="subAgentStatus" style="display: none;">
            <div class="sub-agent-info">
                <div class="sub-agent-icon">üåê</div>
                <div class="sub-agent-details">
                    <h3 id="subAgentTitle">NetworkMapper Sub-Agent</h3>
                    <p id="subAgentDescription">Adaptive scanning ‚Ä¢ Reports to Main Agent</p>
                </div>
            </div>
            <div class="sub-agent-metrics">
                <div class="metric">
                    <div class="metric-value" id="totalNetworks">1</div>
                    <div class="metric-label" id="networksLabel">IP Range</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="discoveredDevices">15</div>
                    <div class="metric-label">Devices</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="openServices">8</div>
                    <div class="metric-label">Services</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="newDevices">2</div>
                    <div class="metric-label">New (24h)</div>
                </div>
            </div>
        </div>

        <!-- IP Range Manager -->
        <div class="ip-range-manager" id="ipRangeManager" style="display: none;">
            <div class="ip-range-header">
                <h2 class="ip-range-title" id="ipRangeTitle">Network Range Management</h2>
                <div class="ip-range-controls">
                    <button class="add-range-btn" onclick="showAddRangeModal()" id="addRangeBtn">Add IP Range</button>
                    <button class="reset-config-btn" onclick="showRescanModal()" title="Reset network discovery and reconfigure environment">
                        <span class="icon">üîÑ</span>
                        <span>Reset Configuration</span>
                    </button>
                </div>
            </div>
            
            <div class="ip-ranges-grid" id="ipRangesGrid">
                <!-- IP ranges will be populated here -->
            </div>
        </div>

        <!-- Interactive Dashboard Section -->
        <div class="dashboard-interactive" id="dashboardInteractive" style="display: none;">
            <div class="interactive-header">
                <h2 class="interactive-title" id="interactiveTitle">Network Discovery Dashboard</h2>
                <div class="auto-scan-controls">
                    <span style="color: var(--text-secondary); font-size: 14px;" id="scanDetails">Continuous Monitoring Active</span>
                    <button class="reset-config-btn" onclick="showRescanModal()" title="Reset network discovery and reconfigure environment">
                        <span class="icon">üîÑ</span>
                        <span>Reset Configuration</span>
                    </button>
                </div>
            </div>
            <p style="color: var(--text-secondary); text-align: center; font-size: 14px; line-height: 1.6;" id="dashboardDescription">
                ü§ñ <strong>Autonomous scanning active</strong> ‚Ä¢ Hybrid-resistant encryption ‚Ä¢ No manual intervention required
            </p>
        </div>

        <!-- Other sections would continue here... -->
    </div>

    <!-- AI Chat Widget -->
    <div class="ai-chat-widget">
        <div class="ai-chat-window" id="aiChatWindow">
            <div class="ai-chat-header">
                <div class="ai-chat-status">
                    <span class="chat-status-dot"></span>
                    <span>MAIN AGENT ONLINE</span>
                </div>
                <span class="ai-chat-close">√ó</span>
            </div>
            <div class="cli-mode-indicator" id="cliModeIndicator">
                ‚ö†Ô∏è CLI MODE - Main Agent Offline
            </div>
            <div class="ai-chat-messages" id="aiChatMessages">
                <div class="ai-message-bubble">
                    Welcome to AI Sentinel-X Adaptive Network Discovery. I'm analyzing your environment to configure the optimal interface. Please select your network scale above, or I'll auto-detect based on your infrastructure.
                </div>
                <div class="ai-message-time">Just now</div>
            </div>
            <div class="ai-chat-input-container">
                <input 
                    type="text" 
                    class="ai-chat-input" 
                    id="aiChatInput" 
                    placeholder="Ask about network configuration, scaling, or security..."
                    onkeypress="handleChatKeyPress(event)"
                >
                <button class="ai-chat-send" onclick="sendChatMessage()">SEND</button>
            </div>
        </div>
        <div class="ai-chat-toggle">ü§ñ</div>
    </div>

    <script src="shared.js"></script>
    <script>
        // Network module state
        let currentScale = null;
        let ipRanges = [];
        let internalDevices = [];
        let deviceCounter = 1;
        let scanningActive = true;
        let discoveryActive = true;

        // Scale configurations
        const ScaleConfigs = {
            individual: {
                icon: 'üåê',
                text: 'SINGLE IP',
                className: 'scale-individual',
                modalTitle: 'üåê Add Server Range',
                maxRanges: 1,
                deviceRange: [5, 25],
                serviceRange: [3, 12],
                description: 'Single server monitoring ‚Ä¢ Essential protection ‚Ä¢ Hybrid-resistant security',
                scanDetails: 'Server + External',
                chatContext: 'single IP deployment with essential security monitoring'
            },
            business: {
                icon: 'üè¢',
                text: 'SMALL BUSINESS',
                className: 'scale-business',
                modalTitle: 'üè¢ Add Business Network',
                maxRanges: 5,
                deviceRange: [25, 250],
                serviceRange: [12, 50],
                description: 'Multi-location scanning ‚Ä¢ Business-grade security ‚Ä¢ Advanced monitoring',
                scanDetails: 'Multi-site + External',
                chatContext: 'small business with multiple locations and enhanced security requirements'
            },
            enterprise: {
                icon: 'üè≠',
                text: 'ENTERPRISE',
                className: 'scale-enterprise',
                modalTitle: 'üè¢ Add Data Center Range',
                maxRanges: 50,
                deviceRange: [250, 5000],
                serviceRange: [50, 200],
                description: 'Enterprise-scale scanning ‚Ä¢ Cross-DC correlation ‚Ä¢ Full data center monitoring',
                scanDetails: 'Multi-DC + Global',
                chatContext: 'enterprise data center with distributed infrastructure and advanced threat correlation'
            }
        };

        // Auto-scan functionality
        function startAutoScan() {
            console.log('Starting auto scan...');
            const autoScanBtn = document.getElementById('autoScanBtn');
            const scanProgress = document.getElementById('scanProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            if (!autoScanBtn || !scanProgress || !progressFill || !progressText) {
                console.error('Missing scan elements');
                return;
            }
            
            // Disable button and show progress
            autoScanBtn.disabled = true;
            scanProgress.style.display = 'block';
            
            // Simulate network scanning process
            const scanSteps = [
                { progress: 15, text: "Detecting public IP addresses..." },
                { progress: 30, text: "Scanning network topology..." },
                { progress: 45, text: "Analyzing service distribution..." },
                { progress: 60, text: "Checking geographic presence..." },
                { progress: 75, text: "Evaluating security requirements..." },
                { progress: 90, text: "Determining optimal solution..." },
                { progress: 100, text: "Scan complete! Recommending deployment..." }
            ];
            
            let currentStep = 0;
            
            const interval = setInterval(() => {
                if (currentStep < scanSteps.length) {
                    const step = scanSteps[currentStep];
                    progressFill.style.width = step.progress + '%';
                    progressText.textContent = step.text;
                    currentStep++;
                } else {
                    clearInterval(interval);
                    
                    // Simulate scan results and recommendation
                    setTimeout(() => {
                        const recommendation = simulateNetworkScan();
                        showScanResults(recommendation);
                    }, 1000);
                }
            }, 800);
            
            // Track scan initiation in chat
            if (window.sentinelChat && SentinelState.chatOpen) {
                sentinelChat.addMessage('üîç NetworkMapper: Auto-scan initiated. Analyzing your network infrastructure to recommend optimal security deployment...', false, 'system');
            }
        }

        function simulateNetworkScan() {
            // Simulate different network configurations
            const scenarios = [
                {
                    type: 'individual',
                    confidence: 92,
                    details: {
                        publicIPs: 1,
                        services: 6,
                        complexity: 'Low',
                        infrastructure: 'Single VPS/Cloud Instance',
                        recommendation: 'Essential Protection is perfect for your setup'
                    }
                },
                {
                    type: 'business',
                    confidence: 87,
                    details: {
                        publicIPs: 3,
                        services: 24,
                        complexity: 'Medium',
                        infrastructure: 'Multi-location business network',
                        recommendation: 'Professional solution recommended for your scale'
                    }
                },
                {
                    type: 'enterprise',
                    confidence: 94,
                    details: {
                        publicIPs: 12,
                        services: 156,
                        complexity: 'High',
                        infrastructure: 'Enterprise data center infrastructure',
                        recommendation: 'Enterprise Defense required for your scale'
                    }
                }
            ];
            
            // Randomly select a scenario (in production, this would be real network analysis)
            return scenarios[Math.floor(Math.random() * scenarios.length)];
        }

        function showScanResults(recommendation) {
            console.log('Showing scan results:', recommendation);
            const scanProgress = document.getElementById('scanProgress');
            const autoScanBtn = document.getElementById('autoScanBtn');
            
            // Hide progress, show results
            if (scanProgress) scanProgress.style.display = 'none';
            if (autoScanBtn) {
                autoScanBtn.disabled = false;
                autoScanBtn.innerHTML = `
                    <span class="scan-icon">‚úÖ</span>
                    <span class="scan-text">Scan Complete</span>
                    <span class="scan-subtitle">Click to rescan network</span>
                `;
            }
            
            // Create results modal
            showScanResultsModal(recommendation);
            
            // Highlight recommended solution
            highlightRecommendedSolution(recommendation.type);
            
            // Update chat with results
            if (window.sentinelChat && SentinelState.chatOpen) {
                sentinelChat.addMessage(`üéØ NetworkMapper: Scan complete! Detected ${recommendation.details.infrastructure}. ${recommendation.details.recommendation}. Confidence: ${recommendation.confidence}%`, false, 'system');
            }
        }

        function showScanResultsModal(recommendation) {
            // Create a results modal with proper sizing
            const modal = document.createElement('div');
            modal.className = 'modal-overlay scan-results-modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal scan-results-modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">üéØ Network Discovery Complete</h2>
                    </div>
                    <div class="modal-content">
                        <div class="scan-results-summary">
                            <div class="summary-grid">
                                <div class="summary-item">
                                    <span class="summary-label">Infrastructure Type</span>
                                    <span class="summary-value">${recommendation.details.infrastructure}</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Detection Confidence</span>
                                    <span class="summary-value">${recommendation.confidence}%</span>
                                </div>
                            </div>
                            
                            <div class="recommendation-banner">
                                <div class="banner-icon">üöÄ</div>
                                <div class="banner-content">
                                    <h3>Recommended Configuration</h3>
                                    <p>${recommendation.details.recommendation}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button class="modal-btn modal-btn-primary" onclick="acceptRecommendation('${recommendation.type}')">
                            Apply Configuration
                        </button>
                        <button class="modal-btn modal-btn-secondary" onclick="closeScanResultsModal()">
                            Choose Manually
                        </button>
                    </div>
                </div>
            `;
            
            // Add improved modal styles
            if (!document.querySelector('#scan-modal-styles')) {
                const style = document.createElement('style');
                style.id = 'scan-modal-styles';
                style.textContent = `
                    .scan-results-modal-content {
                        max-width: 500px;
                        max-height: 80vh;
                        overflow-y: auto;
                    }
                    
                    .scan-results-summary {
                        margin-bottom: 20px;
                    }
                    
                    .summary-grid {
                        display: grid;
                        grid-template-columns: 1fr;
                        gap: 12px;
                        margin-bottom: 20px;
                    }
                    
                    .summary-item {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        padding: 12px;
                        background: rgba(0, 255, 136, 0.05);
                        border: 1px solid rgba(0, 255, 136, 0.2);
                        border-radius: 8px;
                    }
                    
                    .summary-label {
                        font-size: 14px;
                        color: var(--text-secondary);
                        font-weight: 500;
                    }
                    
                    .summary-value {
                        font-size: 14px;
                        font-weight: bold;
                        color: var(--primary);
                    }
                    
                    .recommendation-banner {
                        background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 204, 255, 0.05));
                        border: 1px solid var(--primary);
                        border-radius: 12px;
                        padding: 20px;
                        display: flex;
                        align-items: center;
                        gap: 15px;
                    }
                    
                    .banner-icon {
                        font-size: 32px;
                        flex-shrink: 0;
                    }
                    
                    .banner-content h3 {
                        color: var(--primary);
                        margin-bottom: 8px;
                        font-size: 16px;
                    }
                    
                    .banner-content p {
                        color: var(--text-secondary);
                        font-size: 14px;
                        margin: 0;
                        line-height: 1.4;
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(modal);
            
            // Close on overlay click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeScanResultsModal();
                }
            });
        }

        function closeScanResultsModal() {
            const modal = document.querySelector('.scan-results-modal');
            if (modal) {
                modal.remove();
            }
        }

        function acceptRecommendation(recommendedType) {
            console.log('Accepting recommendation:', recommendedType);
            closeScanResultsModal();
            selectScale(recommendedType, true);
            
            // Show configuration message
            if (window.sentinelChat && SentinelState.chatOpen) {
                sentinelChat.addMessage(`‚úÖ NetworkMapper: Applying ${ScaleConfigs[recommendedType].text} configuration. Your license will be configured for optimal monitoring of your infrastructure.`, false, 'system');
            }
        }

        function highlightRecommendedSolution(recommendedType) {
            // Remove any existing highlights
            document.querySelectorAll('.scale-option').forEach(option => {
                option.classList.remove('recommended');
            });
            
            // Add highlight to recommended solution
            const recommendedOption = document.querySelector(`.scale-option.${recommendedType}`);
            if (recommendedOption) {
                recommendedOption.classList.add('recommended');
                
                // Add a recommended badge
                const header = recommendedOption.querySelector('.scale-header');
                if (header && !header.querySelector('.recommended-badge')) {
                    const badge = document.createElement('div');
                    badge.className = 'recommended-badge';
                    badge.innerHTML = '‚≠ê RECOMMENDED';
                    header.appendChild(badge);
                }
                
                // Scroll into view
                recommendedOption.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            
            // Add CSS for recommended styling if not already added
            if (!document.querySelector('#recommended-styles')) {
                const style = document.createElement('style');
                style.id = 'recommended-styles';
                style.textContent = `
                    .scale-option.recommended {
                        border-color: var(--secondary) !important;
                        box-shadow: 0 0 25px rgba(0, 204, 255, 0.4) !important;
                        animation: recommendedPulse 2s ease-in-out 3;
                    }
                    
                    @keyframes recommendedPulse {
                        0%, 100% { box-shadow: 0 0 25px rgba(0, 204, 255, 0.4); }
                        50% { box-shadow: 0 0 35px rgba(0, 204, 255, 0.6); }
                    }
                    
                    .recommended-badge {
                        background: var(--gradient-2);
                        color: white;
                        padding: 4px 10px;
                        border-radius: 15px;
                        font-size: 10px;
                        font-weight: bold;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                        animation: badgePulse 1s ease-in-out infinite;
                    }
                    
                    @keyframes badgePulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.05); }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // Select scale and configure interface
        function selectScale(scale, userSelected = true) {
            console.log('Selecting scale:', scale);
            if (!ScaleConfigs[scale]) return;

            currentScale = scale;
            if (window.SentinelState) {
                SentinelState.currentScale = scale;
            }
            const config = ScaleConfigs[scale];

            // Hide environment detection
            const envDetection = document.getElementById('environmentDetection');
            if (envDetection) {
                envDetection.style.display = 'none';
            }

            // Update scale indicator
            updateScaleIndicator(config);

            // Update body class for CSS targeting
            document.body.className = `${scale}-mode`;

            // Configure interface based on scale
            configureInterfaceForScale(scale, config);

            // Initialize data for scale
            initializeDataForScale(scale, config);

            // Save preference
            if (userSelected) {
                localStorage.setItem('sentinel_scale', scale);
            }

            // Update chat context
            if (window.sentinelChat && SentinelState.chatOpen && userSelected) {
                sentinelChat.addMessage(`NetworkMapper: Configured for ${config.text.toLowerCase()} scale. Interface adapted for ${config.chatContext}. All features optimized for your environment.`, false, 'system');
            }
        }

        // Update scale indicator
        function updateScaleIndicator(config) {
            const scaleIndicator = document.getElementById('scaleIndicator');
            const scaleIcon = document.getElementById('scaleIcon');
            const scaleText = document.getElementById('scaleText');
            
            if (scaleIndicator && scaleIcon && scaleText) {
                scaleIndicator.className = `scale-indicator ${config.className}`;
                scaleIcon.textContent = config.icon;
                scaleText.textContent = config.text;
            }
        }

        // Configure interface elements based on scale
        function configureInterfaceForScale(scale, config) {
            // Show main sections
            const sections = ['subAgentStatus', 'dashboardInteractive', 'networkOverview', 'ipRangeManager'];
            sections.forEach(sectionId => {
                const element = document.getElementById(sectionId);
                if (element) {
                    element.style.display = sectionId === 'scanningGrid' ? 'grid' : 
                                           sectionId === 'deviceDiscovery' ? 'block' : 
                                           'flex';
                }
            });

            // Update sub-agent description
            const subAgentDesc = document.getElementById('subAgentDescription');
            if (subAgentDesc) {
                subAgentDesc.textContent = config.description;
            }

            // Update dashboard title
            const titles = {
                individual: 'Single IP Discovery',
                business: 'Multi-Site Network Discovery', 
                enterprise: 'Enterprise Network Discovery'
            };
            
            const interactiveTitle = document.getElementById('interactiveTitle');
            if (interactiveTitle) {
                interactiveTitle.textContent = titles[scale];
            }

            const scanDetails = document.getElementById('scanDetails');
            if (scanDetails) {
                scanDetails.textContent = 'Continuous Monitoring Active';
            }

            // Update dashboard description
            const descriptions = {
                individual: 'ü§ñ <strong>Server monitoring active</strong> ‚Ä¢ Hybrid-resistant encryption ‚Ä¢ Automatic threat detection',
                business: 'ü§ñ <strong>Multi-site autonomous scanning</strong> ‚Ä¢ Business-grade encryption ‚Ä¢ Cross-location monitoring',
                enterprise: 'ü§ñ <strong>Enterprise autonomous scanning</strong> ‚Ä¢ Cross-DC correlation ‚Ä¢ Full hybrid-resistant infrastructure'
            };
            
            const dashboardDesc = document.getElementById('dashboardDescription');
            if (dashboardDesc) {
                dashboardDesc.innerHTML = descriptions[scale];
            }

            // Update range manager title
            const ipRangeTitle = document.getElementById('ipRangeTitle');
            if (ipRangeTitle) {
                const rangeTitles = {
                    individual: 'Server Range Management',
                    business: 'Business Network Ranges',
                    enterprise: 'Enterprise IP Range Management'
                };
                ipRangeTitle.textContent = rangeTitles[scale];
            }

            // Update add range button
            const addRangeBtn = document.getElementById('addRangeBtn');
            if (addRangeBtn) {
                addRangeBtn.textContent = scale === 'individual' ? 'Add Server Range' : 'Add IP Range';
            }

            // Update metrics label
            const networksLabel = document.getElementById('networksLabel');
            if (networksLabel) {
                const labels = {
                    individual: 'Server',
                    business: 'Locations', 
                    enterprise: 'IP Ranges'
                };
                networksLabel.textContent = labels[scale];
            }
        }

        // Initialize data structures for each scale
        function initializeDataForScale(scale, config) {
            // Reset data
            ipRanges = [];
            internalDevices = [];
            deviceCounter = 1;

            // Generate appropriate IP ranges based on scale
            if (scale === 'individual') {
                ipRanges = [{
                    id: 'server',
                    name: 'Production Server',
                    range: '203.0.113.42/32',
                    location: 'New York, US',
                    organization: 'DigitalOcean',
                    status: 'Active',
                    devices: 1,
                    services: 6,
                    vulnerabilities: 0,
                    bandwidth: '1Gbps'
                }];
                deviceCounter = 2;
            } else if (scale === 'business') {
                ipRanges = [
                    {
                        id: 'headquarters',
                        name: 'Headquarters',
                        range: '203.0.113.0/26',
                        location: 'Columbia, SC',
                        organization: 'Business Fiber',
                        status: 'Active',
                        devices: 67,
                        services: 12,
                        vulnerabilities: 0,
                        bandwidth: '1Gbps'
                    },
                    {
                        id: 'branch-atlanta',
                        name: 'Atlanta Office',
                        range: '203.0.113.64/27',
                        location: 'Atlanta, GA',
                        organization: 'Business Fiber',
                        status: 'Active',
                        devices: 34,
                        services: 8,
                        vulnerabilities: 1,
                        bandwidth: '500Mbps'
                    },
                    {
                        id: 'branch-charlotte',
                        name: 'Charlotte Office',
                        range: '203.0.113.96/28',
                        location: 'Charlotte, NC',
                        organization: 'Business Fiber',
                        status: 'Active',
                        devices: 26,
                        services: 4,
                        vulnerabilities: 0,
                        bandwidth: '300Mbps'
                    }
                ];
                deviceCounter = 128;
            } else { // enterprise
                ipRanges = [
                    {
                        id: 'primary-east',
                        name: 'Primary-DC-East',
                        range: '203.0.113.0/24',
                        location: 'Virginia, US',
                        organization: 'AS64512',
                        status: 'Active',
                        devices: 847,
                        services: 42,
                        vulnerabilities: 1,
                        bandwidth: '15.8GB/s'
                    },
                    {
                        id: 'secondary-west',
                        name: 'Secondary-DC-West',
                        range: '198.51.100.0/24',
                        location: 'Oregon, US',
                        organization: 'AS64512',
                        status: 'Active',
                        devices: 623,
                        services: 38,
                        vulnerabilities: 0,
                        bandwidth: '12.4GB/s'
                    },
                    {
                        id: 'backup-eu',
                        name: 'Backup-DC-EU',
                        range: '192.0.2.0/24',
                        location: 'Frankfurt, DE',
                        organization: 'AS64513',
                        status: 'Active',
                        devices: 456,
                        services: 28,
                        vulnerabilities: 1,
                        bandwidth: '9.2GB/s'
                    }
                ];
                deviceCounter = 2848;
            }

            // Update metrics display
            updateMetrics();
        }

        function updateMetrics() {
            if (!currentScale) return;

            const totalRanges = ipRanges.length;
            const totalDevices = ipRanges.reduce((sum, range) => sum + range.devices, 0);
            const totalServices = ipRanges.reduce((sum, range) => sum + range.services, 0);

            // Update sub-agent metrics
            const totalNetworks = document.getElementById('totalNetworks');
            const discoveredDevices = document.getElementById('discoveredDevices');
            const openServices = document.getElementById('openServices');

            if (totalNetworks) totalNetworks.textContent = totalRanges.toString();
            if (discoveredDevices) discoveredDevices.textContent = totalDevices.toLocaleString();
            if (openServices) openServices.textContent = totalServices.toString();
        }

        // Initialize environment detection
        function initializeEnvironmentDetection() {
            // Auto-detect based on stored preference or simulate detection
            const savedScale = localStorage.getItem('sentinel_scale');
            if (savedScale && ScaleConfigs[savedScale]) {
                selectScale(savedScale, false);
            } else {
                // Show selection interface
                const envDetection = document.getElementById('environmentDetection');
                if (envDetection) {
                    envDetection.style.display = 'block';
                }
            }
        }

        // Stub functions for other features
        function showAddRangeModal() {
            console.log('Show add range modal');
        }

        function showRescanModal() {
            console.log('Show rescan modal');
        }

        function requestConsultation() {
            if (window.sentinelChat && !SentinelState.chatOpen) {
                sentinelChat.toggle();
            }
            
            setTimeout(() => {
                if (window.sentinelChat) {
                    sentinelChat.addMessage('üìû Thank you for your interest in a security consultation! Our team will contact you within 24 hours to discuss your infrastructure needs and provide personalized recommendations.', false, 'system');
                    sentinelChat.addMessage('In the meantime, feel free to explore our solutions above or ask me any questions about AI Sentinel-X capabilities.', false, 'system');
                }
            }, 500);
        }

        // Chat handlers
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('aiChatInput');
            if (input && window.sentinelChat) {
                const message = input.value.trim();
                if (message) {
                    sentinelChat.sendMessage(message);
                    input.value = '';
                }
            }
        }

        function handleLogout() {
            if (confirm('Are you sure you want to logout? The AI agent will continue protecting your network autonomously.')) {
                localStorage.removeItem('sentinel_auth');
                localStorage.removeItem('sentinel_scale');
                window.location.href = 'index.html';
            }
        }

        function showAgentShutdownModal() {
            console.log('Show agent shutdown modal');
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, initializing...');
            initializeEnvironmentDetection();
        });

        // Global function exports
        window.startAutoScan = startAutoScan;
        window.selectScale = selectScale;
        window.acceptRecommendation = acceptRecommendation;
        window.closeScanResultsModal = closeScanResultsModal;
        window.requestConsultation = requestConsultation;
        window.showAddRangeModal = showAddRangeModal;
        window.showRescanModal = showRescanModal;
        window.handleChatKeyPress = handleChatKeyPress;
        window.sendChatMessage = sendChatMessage;
        window.handleLogout = handleLogout;
        window.showAgentShutdownModal = showAgentShutdownModal;
    </script>
</body>
</html>
